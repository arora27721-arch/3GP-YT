{% extends "base.html" %}

{% block title %}Subtitle Burner - Burn Subtitles into 3GP{% endblock %}

{% block extra_style %}
<style>
    .upload-form {
        display: flex;
        flex-direction: column;
        gap: 25px;
    }
    .form-group {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }
    .form-group label {
        font-weight: 600;
        color: #00d2ff;
        font-size: 1.1rem;
    }
    .form-group .help-text {
        font-size: 0.9rem;
        color: #888;
    }
    .file-input-wrapper {
        position: relative;
        background: rgba(0,0,0,0.3);
        border: 2px dashed #444;
        border-radius: 10px;
        padding: 30px;
        text-align: center;
        transition: all 0.3s;
        cursor: pointer;
    }
    .file-input-wrapper:hover {
        border-color: #00d2ff;
        background: rgba(0,210,255,0.05);
    }
    .file-input-wrapper input[type="file"] {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        cursor: pointer;
    }
    .file-input-wrapper .icon {
        font-size: 2.5rem;
        margin-bottom: 10px;
    }
    .file-input-wrapper .file-name {
        margin-top: 10px;
        color: #00d2ff;
        font-weight: 500;
    }
    .options-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
    }
    @media (max-width: 600px) {
        .options-row {
            grid-template-columns: 1fr;
        }
    }
    select, input[type="number"] {
        width: 100%;
        padding: 12px 15px;
        background: rgba(0,0,0,0.3);
        border: 1px solid #444;
        border-radius: 8px;
        color: #e8e8e8;
        font-size: 1rem;
        cursor: pointer;
    }
    select:focus, input[type="number"]:focus {
        outline: none;
        border-color: #00d2ff;
    }
    .submit-btn {
        margin-top: 10px;
        padding: 15px 30px;
        font-size: 1.1rem;
    }
    .split-section {
        background: rgba(0,210,255,0.1);
        border: 1px solid rgba(0,210,255,0.3);
        border-radius: 10px;
        padding: 20px;
    }
    .split-section h3 {
        color: #00d2ff;
        margin-bottom: 15px;
        font-size: 1.1rem;
    }
    .split-tip {
        background: rgba(255,193,7,0.1);
        border-left: 3px solid #ffc107;
        padding: 12px 15px;
        margin-top: 15px;
        font-size: 0.9rem;
        color: #ccc;
    }
    .time-estimate {
        background: rgba(40,167,69,0.15);
        border: 1px solid rgba(40,167,69,0.3);
        border-radius: 10px;
        padding: 20px;
        margin-top: 20px;
    }
    .time-estimate h3 {
        color: #28a745;
        margin-bottom: 10px;
    }
    .time-table {
        width: 100%;
        font-size: 0.95rem;
    }
    .time-table td {
        padding: 8px 0;
        border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    .time-table td:first-child {
        color: #888;
    }
    .time-table td:last-child {
        text-align: right;
        color: #e8e8e8;
    }
    .features {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 12px;
        margin-top: 25px;
    }
    .feature {
        background: rgba(0,0,0,0.2);
        padding: 12px;
        border-radius: 8px;
        text-align: center;
    }
    .feature-icon {
        font-size: 1.3rem;
        margin-bottom: 5px;
    }
    .feature-text {
        font-size: 0.85rem;
        color: #aaa;
    }
</style>
{% endblock %}

{% block content %}
<div class="card">
    <form action="{{ url_for('upload') }}" method="post" enctype="multipart/form-data" class="upload-form">
        <div class="form-group">
            <label>Video File (MP4, 3GP, MKV, etc.)</label>
            <p class="help-text">Upload your video - output will always be 3GP with burned subtitles</p>
            <div class="file-input-wrapper" id="video-wrapper">
                <div class="icon">&#127909;</div>
                <div>Click or drag to upload video</div>
                <div class="file-name" id="video-name"></div>
                <input type="file" name="video" id="video-input" accept=".mp4,.3gp,.mkv,.avi,.mov,.webm" required>
            </div>
        </div>

        <div class="form-group">
            <label>Subtitle File (SRT, ASS, VTT)</label>
            <p class="help-text">Subtitles will be burned into the video permanently</p>
            <div class="file-input-wrapper" id="subtitle-wrapper">
                <div class="icon">&#128196;</div>
                <div>Click or drag to upload subtitles</div>
                <div class="file-name" id="subtitle-name"></div>
                <input type="file" name="subtitle" id="subtitle-input" accept=".srt,.ass,.vtt" required>
            </div>
        </div>

        <div class="options-row">
            <div class="form-group">
                <label>3GP Quality</label>
                <select name="quality" id="quality-select">
                    <option value="low">Low (Smallest file, 2G friendly)</option>
                    <option value="medium" selected>Medium (Balanced)</option>
                    <option value="high">High (Best quality, larger file)</option>
                </select>
            </div>

            <div class="form-group">
                <label>Split into Parts</label>
                <select name="split_parts" id="split-select">
                    <option value="0">No splitting (single file)</option>
                    <option value="2">2 parts</option>
                    <option value="3">3 parts</option>
                    <option value="4">4 parts</option>
                    <option value="5">5 parts</option>
                    <option value="6">6 parts</option>
                    <option value="8">8 parts</option>
                    <option value="10">10 parts</option>
                    <option value="15">15 parts</option>
                    <option value="20">20 parts</option>
                </select>
            </div>
        </div>

        <div class="split-section">
            <h3>Smart Splitting</h3>
            <p class="help-text">Split your video into smaller parts for easier transfer to feature phones. Each part is fully re-encoded for maximum compatibility.</p>
            <div class="split-tip">
                <strong>Tip:</strong> For 2G networks, split long videos into 5-10 minute parts (about 3-5MB each). A 30-min video works well with 6 parts. A 31-hour video might need 20+ parts for easier download.
            </div>
        </div>

        <div class="time-estimate">
            <h3>Estimated Processing Time</h3>
            <table class="time-table">
                <tr>
                    <td>5 min video</td>
                    <td>~1-2 minutes</td>
                </tr>
                <tr>
                    <td>30 min video</td>
                    <td>~5-10 minutes</td>
                </tr>
                <tr>
                    <td>2 hour movie</td>
                    <td>~30-60 minutes</td>
                </tr>
                <tr>
                    <td>31 hour video (2.5GB)</td>
                    <td>~2-4 hours (Cloud Shell) / ~6-10 hours (Replit)</td>
                </tr>
            </table>
            <p style="font-size: 0.85rem; color: #888; margin-top: 10px;">* Times depend on server load and video complexity</p>
        </div>

        <button type="submit" class="btn submit-btn">Burn Subtitles into 3GP</button>
    </form>
</div>

<div class="features">
    <div class="feature">
        <div class="feature-icon">&#9889;</div>
        <div class="feature-text">Multi-core processing</div>
    </div>
    <div class="feature">
        <div class="feature-icon">&#128247;</div>
        <div class="feature-text">3GP output for feature phones</div>
    </div>
    <div class="feature">
        <div class="feature-icon">&#128268;</div>
        <div class="feature-text">Smart splitting</div>
    </div>
    <div class="feature">
        <div class="feature-icon">&#127760;</div>
        <div class="feature-text">SRT/ASS/VTT support</div>
    </div>
</div>
{% endblock %}

{% block extra_script %}
<script>
document.getElementById('video-input').addEventListener('change', function(e) {
    var fileName = e.target.files[0] ? e.target.files[0].name : '';
    var fileSize = e.target.files[0] ? (e.target.files[0].size / (1024*1024)).toFixed(1) + ' MB' : '';
    document.getElementById('video-name').textContent = fileName + (fileSize ? ' (' + fileSize + ')' : '');
});

document.getElementById('subtitle-input').addEventListener('change', function(e) {
    var fileName = e.target.files[0] ? e.target.files[0].name : '';
    document.getElementById('subtitle-name').textContent = fileName;
});
</script>
{% endblock %}
